<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>SOQCS Example 8: Entanglement swapping protocol using a physical quantum dot as a non-ideal Bell emitter. &mdash; SOQCS 1.5 documentation</title>
      <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="_static/css/extended.css" type="text/css" />
      <link rel="stylesheet" href="_static/nbsphinx-code-cells.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/doctools.js"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
        <script>window.MathJax = {"tex": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true}, "options": {"ignoreHtmlClass": "tex2jax_ignore|mathjax_ignore|document", "processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
        <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="SOQCS Example 9: Dielectric film with losses." href="live9.html" />
    <link rel="prev" title="SOQCS Example 7: Boson sampling example." href="live7.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="index.html" class="icon icon-home"> SOQCS
            <img src="_static/Logo.png" class="logo" alt="Logo"/>
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="intro.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="install.html">Compilation and installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="details_pub.html">Software details</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="program.html">Examples</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="live1.html"> Example 1: Elementary example program</a></li>
<li class="toctree-l2"><a class="reference internal" href="live2.html"> Example 2: CNOT circuit</a></li>
<li class="toctree-l2"><a class="reference internal" href="live3.html"> Example 3: CZ</a></li>
<li class="toctree-l2"><a class="reference internal" href="live4.html"> Example 4: HOM Visibility simulation of a 2x2 MMI beamsplitter.</a></li>
<li class="toctree-l2"><a class="reference internal" href="live5.html"> Example 5: Partial distinguishability</a></li>
<li class="toctree-l2"><a class="reference internal" href="live6.html"> Example 6: Simulation of a delay in the middle of a circuit</a></li>
<li class="toctree-l2"><a class="reference internal" href="live7.html"> Example 7: Boson sampling example</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#"> Example 8: Entanglement swapping protocol using a physical quantum dot as a non-ideal Bell emitter</a></li>
<li class="toctree-l2"><a class="reference internal" href="live9.html"> Example 9: Dielectric film with losses</a></li>
<li class="toctree-l2"><a class="reference internal" href="benchmark.html"> Benchmark</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="api.html">API</a></li>
<li class="toctree-l1"><a class="reference internal" href="genindex.html">Index</a></li>
<li class="toctree-l1"><a class="reference internal" href="biblio.html">Bibliography</a></li>
<li class="toctree-l1"><a class="reference internal" href="licence.html">Licence and copyright</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">SOQCS</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home"></a> &raquo;</li>
          <li><a href="program.html">Examples</a> &raquo;</li>
      <li>SOQCS Example 8: Entanglement swapping protocol using a physical quantum dot as a non-ideal Bell emitter.</li>
      <li class="wy-breadcrumbs-aside">
            <a href="_sources/live8.ipynb.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="SOQCS-Example-8:-Entanglement-swapping-protocol-using-a-physical-quantum-dot-as-a-non-ideal-Bell-emitter.">
<h1>SOQCS Example 8: Entanglement swapping protocol using a physical quantum dot as a non-ideal Bell emitter.<a class="headerlink" href="#SOQCS-Example-8:-Entanglement-swapping-protocol-using-a-physical-quantum-dot-as-a-non-ideal-Bell-emitter." title="Permalink to this headline"></a></h1>
<p style="text-align: justify;"><p>In the entanglement swapping protocol two pairs of photons are emitted in entangled Bell states. One photon of each pair is sent to a beamsplitter and the result at the output of the beamsplitter is measured. If one photon is detected in each output channel of the beamsplitter then the remaining two photons are also entangled. However, if the two pairs are not ideal Bell states misdetections can happen and the resulting density matrix of the two photons not traveling by the beamsplitter will not
be the one of a pure state of a perfectly entangled pair of photons. In this simulation we will perform the protocol in the same way as depicted in [1]. This is, the two photons not traveling trough the beamsplitter will arrive at the detector through the same channel but at different times that here are labeled as 0 and 1. The calculation is repeated with different instances of the state of the QD emitter to capture the effect on the output of the distribution of noise in the input. We consider
random noise, cross-dephasing noise and FSS effects on the photons that may give different imperfections to the input state in each emission. The result is compared with the analytical result for the current parameters. Note that we are neglecting pure dephasing effects in this example (this is T2* = 0)</p>
</p><p>[1] F. Basso Basset et Al. Entanglement swapping with photons generated on demand by a quantum dot. Phys. Rev. Lett., 123:160501 (2019)</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[1]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">soqcs</span>
</pre></div>
</div>
</div>
<p>Simulation constant</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[2]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">N</span>      <span class="o">=</span>  <span class="mi">10000</span>  <span class="c1"># Number of outputs to calculate the density matrix</span>
<span class="n">prntn</span>  <span class="o">=</span>   <span class="mi">1000</span>  <span class="c1"># Print a message each 1000</span>
</pre></div>
</div>
</div>
<p>Perform the simulation.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[3]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Initialize variables</span>
<span class="n">V</span><span class="o">=</span><span class="mf">0.0</span><span class="p">;</span>
<span class="n">sim</span> <span class="o">=</span> <span class="n">soqcs</span><span class="o">.</span><span class="n">simulator</span><span class="p">()</span>
<span class="n">apd</span> <span class="o">=</span> <span class="n">soqcs</span><span class="o">.</span><span class="n">dmatrix</span><span class="p">()</span>

<span class="c1"># Main loop</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Start run of: &quot;</span><span class="p">,</span><span class="n">N</span><span class="p">)</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">N</span><span class="p">,</span><span class="mi">1</span><span class="p">):</span>
    <span class="k">if</span><span class="p">(</span><span class="n">i</span><span class="o">%</span><span class="k">prntn</span>==0):
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Running:&quot;</span><span class="p">,</span> <span class="n">i</span><span class="p">)</span>

    <span class="n">example</span> <span class="o">=</span> <span class="n">soqcs</span><span class="o">.</span><span class="n">qodev</span><span class="p">(</span><span class="n">nph</span>  <span class="o">=</span> <span class="mi">4</span><span class="p">,</span>  <span class="c1"># Number of photons</span>
                          <span class="n">nch</span>  <span class="o">=</span> <span class="mi">3</span><span class="p">,</span>  <span class="c1"># Number of channels</span>
                          <span class="n">nm</span>   <span class="o">=</span> <span class="mi">2</span><span class="p">,</span>  <span class="c1"># number of polarization modes</span>
                          <span class="n">ns</span>   <span class="o">=</span> <span class="mi">4</span><span class="p">,</span>  <span class="c1"># Number of packets</span>
                          <span class="n">clock</span><span class="o">=</span> <span class="mi">1</span><span class="p">,</span>  <span class="c1"># Detectors have a clock</span>
                          <span class="n">ckind</span><span class="o">=</span><span class="s1">&#39;E&#39;</span><span class="p">)</span> <span class="c1"># Exponential wavepackets</span>
    <span class="c1"># First QD cascade</span>
    <span class="n">example</span><span class="o">.</span><span class="n">add_QD</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span>
                   <span class="n">t1</span> <span class="o">=</span>  <span class="mf">0.0</span><span class="p">,</span>  <span class="c1"># Time of bi-exciton XX photon</span>
                   <span class="n">f1</span> <span class="o">=</span>  <span class="mf">1.0</span><span class="p">,</span>  <span class="c1"># Frequency of bi-exciton XX photons</span>
                   <span class="n">w1</span> <span class="o">=</span>  <span class="mf">1.0</span><span class="p">,</span>  <span class="c1"># Characteristic decay time of bi-exciton XX photon</span>
                   <span class="n">t2</span> <span class="o">=</span><span class="mf">46.71</span><span class="p">,</span>  <span class="c1"># Time of exciton X photon</span>
                   <span class="n">f2</span> <span class="o">=</span>  <span class="mf">1.0</span><span class="p">,</span>  <span class="c1"># Frequency of bi-exciton X photons</span>
                   <span class="n">w2</span> <span class="o">=</span>  <span class="mf">1.0</span><span class="p">,</span>  <span class="c1"># Characteristic decay time of bi-exciton X photon</span>
                   <span class="n">S</span>  <span class="o">=</span>  <span class="mf">1.0</span><span class="p">,</span>  <span class="c1"># Fine Structure Splitting</span>
                   <span class="n">k</span>  <span class="o">=</span>  <span class="mf">0.8</span><span class="p">,</span>  <span class="c1"># Ratio of photons that are not due to noise</span>
                   <span class="n">tss</span><span class="o">=</span>  <span class="mf">1.0</span><span class="p">,</span>  <span class="c1"># Characteristic coherence time.</span>
                   <span class="n">thv</span><span class="o">=</span>  <span class="mf">1.0</span><span class="p">)</span>  <span class="c1"># Characteristic cross-dephasing time.</span>
    <span class="n">example</span><span class="o">.</span><span class="n">add_QD</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span>
                   <span class="n">t1</span> <span class="o">=</span> <span class="mf">16.0</span><span class="p">,</span>  <span class="c1"># Time of bi-exciton XX photon</span>
                   <span class="n">f1</span> <span class="o">=</span>  <span class="mf">1.0</span><span class="p">,</span>  <span class="c1"># Frequency of bi-exciton XX photons</span>
                   <span class="n">w1</span> <span class="o">=</span>  <span class="mf">1.0</span><span class="p">,</span>  <span class="c1"># Characteristic decay time of bi-exciton XX photon</span>
                   <span class="n">t2</span> <span class="o">=</span> <span class="mf">46.5</span><span class="p">,</span>  <span class="c1"># Time of exciton X photon</span>
                   <span class="n">f2</span> <span class="o">=</span>  <span class="mf">1.0</span><span class="p">,</span>  <span class="c1"># Frequency of bi-exciton X photons</span>
                   <span class="n">w2</span> <span class="o">=</span>  <span class="mf">1.0</span><span class="p">,</span>  <span class="c1"># Characteristic decay time of bi-exciton X photon</span>
                   <span class="n">S</span>  <span class="o">=</span>  <span class="mf">1.0</span><span class="p">,</span>  <span class="c1"># Fine Structure Splitting</span>
                   <span class="n">k</span>  <span class="o">=</span>  <span class="mf">0.8</span><span class="p">,</span>  <span class="c1"># Ratio of photons that are not due to noise</span>
                   <span class="n">tss</span><span class="o">=</span>  <span class="mf">1.0</span><span class="p">,</span>  <span class="c1"># Characteristic coherence time.</span>
                   <span class="n">thv</span><span class="o">=</span>  <span class="mf">1.0</span><span class="p">)</span>  <span class="c1"># Characteristic cross-dephasing time.</span>
    <span class="c1"># Circuit</span>
    <span class="n">example</span><span class="o">.</span><span class="n">beamsplitter</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mf">45.0</span><span class="p">,</span><span class="mf">0.0</span><span class="p">);</span>
    <span class="c1"># Detectors</span>
    <span class="n">example</span><span class="o">.</span><span class="n">detector</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
    <span class="n">example</span><span class="o">.</span><span class="n">detector</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">example</span><span class="o">.</span><span class="n">detector</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>

    <span class="c1"># Run simulation</span>
    <span class="n">inputst</span><span class="o">=</span><span class="n">example</span><span class="o">.</span><span class="n">input</span><span class="p">()</span>               <span class="c1"># Obtain input stste</span>
    <span class="n">circuit</span><span class="o">=</span><span class="n">example</span><span class="o">.</span><span class="n">circuit</span><span class="p">()</span>             <span class="c1"># Obtain circuit</span>
    <span class="n">outputst</span><span class="o">=</span><span class="n">sim</span><span class="o">.</span><span class="n">run_st</span><span class="p">(</span><span class="n">inputst</span><span class="p">,</span><span class="n">circuit</span><span class="p">)</span>  <span class="c1"># Run the simulation</span>

    <span class="c1"># Add state to the density matrix</span>
    <span class="n">apd</span><span class="o">.</span><span class="n">add_state</span><span class="p">(</span><span class="n">outputst</span><span class="p">,</span><span class="n">example</span><span class="p">)</span>

    <span class="c1"># Calculate average photon overlapping</span>
    <span class="n">V</span><span class="o">=</span><span class="n">V</span><span class="o">+</span><span class="n">example</span><span class="o">.</span><span class="n">emitted_vis</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Start run of:  10000
Running: 0
Running: 1000
Running: 2000
Running: 3000
Running: 4000
Running: 5000
Running: 6000
Running: 7000
Running: 8000
Running: 9000
</pre></div></div>
</div>
<p>Print average overlapping.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[4]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;V: &quot;</span><span class="p">,</span><span class="n">V</span><span class="o">/</span><span class="n">N</span><span class="p">,</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
V:  0.8105842459701214

</pre></div></div>
</div>
<p>Print density matrix. First we must apply post-selection manually because we have used run_st.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[5]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">apd</span><span class="o">.</span><span class="n">normalize</span><span class="p">();</span>                    <span class="c1"># Normalize</span>
<span class="n">partial</span><span class="o">=</span><span class="n">apd</span><span class="o">.</span><span class="n">calc_measure</span><span class="p">(</span><span class="n">example</span><span class="p">);</span>  <span class="c1"># Calculate post-selection</span>
<span class="n">partial</span><span class="o">.</span><span class="n">prnt_mtx</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mf">0.01</span><span class="p">,</span><span class="n">example</span><span class="p">);</span>   <span class="c1"># Print the matrix</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
<span class="ansi-cyan-fg"> | H(2)0</span><span class="ansi-cyan-fg">, V(0)0</span><span class="ansi-cyan-fg"> &gt;</span>  0.2766  0.0000  0.0000 -0.0214
<span class="ansi-cyan-fg"> | V(0)0</span><span class="ansi-cyan-fg">, V(2)0</span><span class="ansi-cyan-fg"> &gt;</span>  0.0000  0.2272  0.0000  0.0000
<span class="ansi-cyan-fg"> | H(0)0</span><span class="ansi-cyan-fg">, H(2)0</span><span class="ansi-cyan-fg"> &gt;</span>  0.0000  0.0000  0.2190  0.0000
<span class="ansi-cyan-fg"> | H(0)0</span><span class="ansi-cyan-fg">, V(2)0</span><span class="ansi-cyan-fg"> &gt;</span> -0.0214  0.0000  0.0000  0.2773

</pre></div></div>
</div>
<p><strong>THIS CODE IS PART OF SOQCS</strong></p>
<p><strong>Copyright:</strong> Copyright © 2023 National University of Ireland Maynooth, Maynooth University. All rights reserved. The contents and use of this document and the related code are subject to the licence terms detailed in LICENCE.txt</p>
</section>


           </div>
          </div>
          ﻿<footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="live7.html" class="btn btn-neutral float-left" title="SOQCS Example 7: Boson sampling example." accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="live9.html" class="btn btn-neutral float-right" title="SOQCS Example 9: Dielectric film with losses." accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
<jinja2.runtime.BlockReference object at 0x7fb8972b5d00>
<html lang="en">
<style type="text/css">

<style>
.footer {
    background:white;   
}
.ft-list {
    text-align:left;
    list-style:none;
    overflow:hidden;/*contain floats*/
    margin:0 auto;
    padding:0;
    height:150px;
    background:white;
    border-top-width: 1px;
    border-top-style: solid;
    border-top-color: darkblue;
    
}
.ft-list li {
    float:right;
    margin:0 15px 0 0;
    background:white;
}

.ft-list li.last {margin:0;}

</style>
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
<div class="ft-list"
  <ul>
     <li>
            <p style="color:black"> 
            <b>Maynooth Univeristy</b><br>
            <img src="../../assets/Maynooth2.png"/>
            </p>
    </li>

    <li>
            <p style="color:black">
            <b>Copyright:</b><br>
            Copyright © 2023 National University of Ireland Maynooth, 
            <br> Maynooth University. All rights reserved.<br>
            The contents and use of this document and the related code <br>
            are subject to the licence terms detailed in <a  href="../../assets/LICENCE.TXT"> LICENCE.txt </a> 
            </p>
    </li>

    <li>
            <p style="color:black">
            <br>
            Jiri Vala <br>
            <br>
            <b>e-mail:</b><br>
            <a  href="mailto:jiri.vala@mu.ie">jiri.vala@mu.ie</a>
            </p>
    </li>
    
    
    <li>
            <p style="color:black">
            <b>Authorship:</b><br>
            Javier Osca Cotarelo<br>
            <br>
            <b>e-mail:</b><br>
            <a  href="mailto:soqcslib@gmail.com">soqcslib@gmail.com</a>
            </p>
    </li>
  </ul>
</div>
</div>
</html>
<!-- your custom footer here-->

  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>