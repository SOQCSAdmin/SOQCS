<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.14"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>SOQCS: live4.cpp</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
  $(document).ready(initResizable);
/* @license-end */</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
  $(document).ready(function() { init_search(); });
/* @license-end */
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="Logo.png"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">SOQCS
   &#160;<span id="projectnumber">RV1.0 (Beta)</span>
   </div>
   <div id="projectbrief">Stochastic Optical Quantum Circuit Simulator</div>
  </td>
   <td>        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
</td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.14 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('live4_8cpp-example.html','');});
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">live4.cpp</div>  </div>
</div><!--header-->
<div class="contents">
<p><b>EXAMPLE 4</b>: Entanglement swapping protocol using a physical quantum dot as a non-ideal Bell emitter.<br />
 Entanglement swapping protocol as presented in ref. [1] in which a quantum dot is used as a non-ideal Bell emitter. We consider random noise errors due spin scattering, cross dephasing and fine structure splitting FSS in the emission of the photons. <br />
<br />
 <b>Description</b>:<br />
 In the entanglement swapping protocol two pairs of photons are emitted in entangled Bell states. One photon of each pair is sent to a beamsplitter and the result at the output of the beamsplitter is measured. If one photon is detected in each output channel of the beamsplitter then the remaining two photons are also entangled. However, if the two pairs are not ideal Bell states misdetections can happen and the resulting density matrix of the two photons not traveling by the beamsplitter will not be the one of a pure state of a perfectly entangled pair of photons. In this simulation we will perform the protocol in the same way than depicted in [1]. This is, the two photons not traveling trough the beamsplitter will arrive at the detector through the same channel but at different times that here are labeled as 0 and 1. The calculation is repeated with different instances of the state of the QD emitter to capture the effect on the output of the distribution of noise in the input. We consider random noise, cross-dephasing noise and FSS effects on the photons that may give different imperfections to the input state in each emission. The result is compared with the analytical result for the current parameters. Note that we are neglecting pure dephasing effects in this example (this is T<sub>2</sub><sup>*</sup> = 0) because they are computer costly but they can be calculated in a longer time with small modifications to this code. We also use an ideal beamsplitter for simplicity. <br />
 <br />
 <br />
 [1] F. Basso Basset et Al. <em>Entanglement swapping with photons generated on demand by a quantum dot.</em> <b>Phys. Rev. Lett., 123:160501</b> (2019)<br />
 <br />
</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">const</td><td>int N Number of iterations to calculate the result. </td></tr>
    <tr><td class="paramname">const</td><td>int prntn Number of iterations to print a progreess if the calculation message</td></tr>
  </table>
  </dd>
</dl>
<p><br />
 Output: <br />
 </p><table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadLeft">SOQCS result   </th></tr>
<tr class="markdownTableBody" class="markdownTableRowOdd">
<td class="markdownTableBodyLeft"><div class="image">
<img src="live4.png" alt="live4.png"/>
</div>
  </td></tr>
</table>
<p><br />
</p>
<p><br />
 Analytical result ref. [1]: <br />
 </p><table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadLeft">Analytic result   </th></tr>
<tr class="markdownTableBody" class="markdownTableRowOdd">
<td class="markdownTableBodyLeft"><div class="image">
<img src="live4_analytic.png" alt="live4_analytic.png"/>
</div>
  </td></tr>
</table>
<p><br />
 Note that in this output the outcomes are labeled by the polarization of the photons H/V, their time of arrival to the detector in parenthesis (in this case 0=first and 1=second) and their channels. In this case both photons arrive in channel zero but delayed in time.<br />
 <br />
</p>
<div class="fragment"><div class="line"></div><div class="line"><span class="preprocessor">#include &quot;<a class="code" href="soqcs_8h.html">soqcs.h</a>&quot;</span></div><div class="line"><span class="preprocessor">#include &lt;chrono&gt;</span></div><div class="line"></div><div class="line"></div><div class="line"><span class="comment">//  Configuration constants</span></div><div class="line"><span class="keyword">const</span> <span class="keywordtype">int</span>    <a name="a0"></a><a class="code" href="live4_8cpp.html#ab2b6b0c222cd1ce70d6a831f57241e59">N</a>      =  10000;        <span class="comment">// Number of iterations</span></div><div class="line"><span class="keyword">const</span> <span class="keywordtype">int</span>    <a name="a1"></a><a class="code" href="live4_8cpp.html#abf3594933a9cef13ea9e06fddb37644b">prntn</a>  =   1000;        <span class="comment">// Number of iterations to print.</span></div><div class="line"></div><div class="line"><span class="keywordtype">int</span> <a name="a2"></a><a class="code" href="live4_8cpp.html#ae66f6b31b5ad750f1fe042a706a4e3d4">main</a>()</div><div class="line">{</div><div class="line">    cout &lt;&lt; <span class="stringliteral">&quot;* Example 4: Entanglement swapping protocol&quot;</span> &lt;&lt; endl;</div><div class="line">    cout &lt;&lt; endl;</div><div class="line"></div><div class="line">    <span class="comment">// Configure SOQCS</span></div><div class="line">    <a name="a3"></a><a class="code" href="util_8cpp.html#ab270dc9e2a3a83187f52c22be3136427">cfg_soqcs</a>(4);</div><div class="line"></div><div class="line">    <span class="comment">// Create simulation structures</span></div><div class="line">    <a class="code" href="util_8h.html#ab2640c1c094b8048e0679e1b1d415a28">mati</a> ch;</div><div class="line">    ch.resize(3,4);</div><div class="line">    <span class="keyword">auto</span> example = <span class="keyword">new</span> <a name="_a4"></a><a class="code" href="classqocircuit.html">qocircuit</a>(3,2,4,1);</div><div class="line">    <span class="keyword">auto</span> sim= <span class="keyword">new</span> <a name="_a5"></a><a class="code" href="classsimulator.html">simulator</a>();</div><div class="line">    <span class="keyword">auto</span> apd=<span class="keyword">new</span> <a name="_a6"></a><a class="code" href="classdmatrix.html">dmatrix</a>();</div><div class="line"></div><div class="line"></div><div class="line">    <span class="keyword">auto</span> <a name="a7"></a><a class="code" href="qocircuit_8h.html#ac5dc2e25ee3e4af146d8ccdb65cf43da">V</a>=0.0;</div><div class="line">    cout &lt;&lt; <span class="stringliteral">&quot;Start run of: &quot;</span> &lt;&lt; <a class="code" href="live4_8cpp.html#ab2b6b0c222cd1ce70d6a831f57241e59">N</a> &lt;&lt; endl;</div><div class="line">    <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i=0;i&lt;<a class="code" href="live4_8cpp.html#ab2b6b0c222cd1ce70d6a831f57241e59">N</a>;i++){</div><div class="line">        <span class="comment">// After prntn iteration print run number</span></div><div class="line">        <span class="keywordflow">if</span>(i%<a class="code" href="live4_8cpp.html#abf3594933a9cef13ea9e06fddb37644b">prntn</a>==0) cout &lt;&lt; <span class="stringliteral">&quot;Running:&quot;</span> &lt;&lt; i &lt;&lt; endl;</div><div class="line"></div><div class="line">        <span class="comment">// build circuit</span></div><div class="line">        example-&gt;reset();</div><div class="line">        example-&gt;def_packet(0,        0.0, 10000.0, 1.0);    <span class="comment">// XX1</span></div><div class="line">        example-&gt;def_packet(1,       16.4, 10000.0, 1.0);    <span class="comment">// XX2</span></div><div class="line">        example-&gt;def_packet(2,      16.71, 10000.0, 1.0);    <span class="comment">//  X1(+dt)</span></div><div class="line">        example-&gt;def_packet(3,       16.5, 10000.0, 1.0);    <span class="comment">//  X2</span></div><div class="line">        example-&gt;emitter(<span class="charliteral">&#39;E&#39;</span>,0);</div><div class="line">        example-&gt;beamsplitter(1,2,45.0,0.0);</div><div class="line">        example-&gt;detector(0);</div><div class="line">        example-&gt;detector(1,1);</div><div class="line">        example-&gt;detector(2,1);</div><div class="line"></div><div class="line">        <span class="comment">// QD emission configuration</span></div><div class="line">        ch  &lt;&lt; 0, 1, 0, 2, <span class="comment">// Channels</span></div><div class="line">               0, 2, 1, 3, <span class="comment">// H Polarization packets</span></div><div class="line">               0, 2, 1, 3; <span class="comment">// P Polarization packets</span></div><div class="line">        <span class="keyword">auto</span> input=<span class="keyword">new</span> <a name="_a8"></a><a class="code" href="classstate.html">state</a>(example-&gt;num_levels());</div><div class="line">        input-&gt;<a name="a9"></a><a class="code" href="classstate.html#ac155d2923de8fc67a0791b1753e46eb0">QD</a>(ch,0.8,1.0,1.0,1.0,example);</div><div class="line"></div><div class="line">        <span class="comment">//Run</span></div><div class="line">        <span class="keyword">auto</span> output=sim-&gt;run(input,example);</div><div class="line"></div><div class="line">        <span class="comment">// Conditional detection</span></div><div class="line">        apd-&gt;add_state(output,example);</div><div class="line"></div><div class="line">        <span class="comment">//Average visibility calculation</span></div><div class="line">        <a class="code" href="qocircuit_8h.html#ac5dc2e25ee3e4af146d8ccdb65cf43da">V</a>=<a class="code" href="qocircuit_8h.html#ac5dc2e25ee3e4af146d8ccdb65cf43da">V</a>+example-&gt;emitted_vis(2,3);</div><div class="line"></div><div class="line">        <span class="keyword">delete</span> output;</div><div class="line">        <span class="keyword">delete</span> input;</div><div class="line">    }</div><div class="line">    cout &lt;&lt; <span class="stringliteral">&quot;End run&quot;</span> &lt;&lt; endl;</div><div class="line">    cout &lt;&lt; endl;</div><div class="line"></div><div class="line">    <span class="comment">// Calculate and print average visibility</span></div><div class="line">    cout &lt;&lt; <span class="stringliteral">&quot;Print visibility:&quot;</span> &lt;&lt; endl;</div><div class="line">    cout &lt;&lt; <span class="stringliteral">&quot;V: &quot;</span> &lt;&lt; <a class="code" href="qocircuit_8h.html#ac5dc2e25ee3e4af146d8ccdb65cf43da">V</a>/(double)<a class="code" href="live4_8cpp.html#ab2b6b0c222cd1ce70d6a831f57241e59">N</a> &lt;&lt; endl &lt;&lt; endl;</div><div class="line"></div><div class="line">    <span class="comment">// Print matrix</span></div><div class="line">    cout &lt;&lt; <span class="stringliteral">&quot;Print matrix:&quot;</span> &lt;&lt; endl&lt;&lt; endl;</div><div class="line">    example-&gt;set_prnt_flag(2);</div><div class="line">    apd-&gt;normalize();</div><div class="line">    <span class="keyword">auto</span> partial=apd-&gt;calc_measure(example);</div><div class="line">    partial-&gt;prnt_mtx(0.01,example);</div><div class="line">}</div><div class="line"></div><div class="line"><span class="comment">//*********************************************************************************************************</span></div><div class="line"><span class="comment">// Copyright © 2022 National University of Ireland Maynooth, Maynooth University. All rights reserved.    *</span></div><div class="line"><span class="comment">// The contents of this file are subject to the licence terms detailed in LICENCE.TXT available in the    *</span></div><div class="line"><span class="comment">// root directory of this source tree. Use of the source code in this file is only permitted under the    *</span></div><div class="line"><span class="comment">// terms of the licence in LICENCE.TXT.                                                                   *</span></div><div class="line"><span class="comment">//*********************************************************************************************************</span></div></div><!-- fragment --> </div><!-- contents -->
</div><!-- doc-content -->
<html lang="en">
<style type="text/css">
<style>
.footer {
    background:white;   
}
.ft-list {
    text-align:left;
    list-style:none;
    overflow:hidden;/*contain floats*/
    margin:0 auto;
    padding:0;
    height:150px;
    background:white;
    border-top-width: 1px;
    border-top-style: solid;
    border-top-color: darkblue;
}
.ft-list li {
    float:right;
    margin:0 15px 0 0;
    background:white;
}
.ft-list li.last {margin:0;}
</style>
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
<div class="ft-list"
  <ul>
     <li>
            <p style="color:black"> 
            <b>Maynooth Univeristy</b><br>
            <img src="../assets/Maynooth2.png"/>
            </p>
    </li>
    <li>
            <p style="color:black">
            <b>Copyright:</b><br>
            Copyright Â© 2022 National University of Ireland Maynooth, 
            <br> Maynooth University. All rights reserved.<br>
            The contents and use of this document and the related code <br>
            are subject to the licence terms detailed in <a  href="../assets/LICENCE.TXT"> LICENCE.txt </a> 
            </p>
    </li>
    <li>
            <p style="color:black">
            <br>
            Jiri Vala <br>
            <br>
            <b>e-mail:</b><br>
            <a  href="mailto:jiri.vala@mu.ie">jiri.vala@mu.ie</a>
            </p>
    </li>
    <li class="last">
            <p style="color:black">
            <b>Authorship:</b><br>
            Javier Osca Cotarelo<br>
            <br>
            <b>e-mail:</b><br>
            <a  href="mailto:javier.oscacotarelo@mu.ie">javier.oscacotarelo@mu.ie</a>
            </p>
    </li>
  </ul>
</div>
</div>
</html>
